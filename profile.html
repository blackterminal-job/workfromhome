<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>My Profile | BlackTerminal</title>

  <style>
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:#f6f7fb;color:#111}
    .nav{position:sticky;top:0;background:#0b1220;color:#fff;padding:12px 16px;z-index:9}
    .navin{max-width:1050px;margin:auto;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:center}
    .brand{font-weight:950}
    .menu{display:flex;gap:10px;flex-wrap:wrap}
    .menu a{color:#fff;text-decoration:none;font-weight:850;font-size:13px;opacity:.92}
    .wrap{max-width:1050px;margin:auto;padding:16px}
    .hero{background:#0b1220;color:#fff;padding:18px;border-radius:16px}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.12);font-weight:900;font-size:12px}
    h1{margin:10px 0 8px;font-size:24px}
    p{margin:0;opacity:.9;line-height:1.6;font-weight:700}

    .box{margin-top:14px;padding:16px;border:1px solid #e9e9e9;border-radius:16px;background:#fff}
    input{
      width:100%;padding:12px 12px;border-radius:14px;border:1px solid #e9e9e9;
      font-weight:900;outline:none;margin-top:10px
    }
    input:focus{border-color:#0a84ff}
    .btn{
      margin-top:10px;width:100%;
      border:none;border-radius:14px;padding:12px 14px;font-weight:950;cursor:pointer;
      background:#0a84ff;color:#fff
    }

    .profile{
      margin-top:14px;
      padding:16px;
      border-radius:16px;
      border:1px solid #e9e9e9;
      background:#fff;
      display:none;
    }

    .pgrid{
      margin-top:12px;
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:10px;
    }
    .pcard{
      border:1px solid #eee;border-radius:14px;padding:12px;background:#f9fafc;text-align:center
    }
    .pcard b{font-size:22px;font-weight:950;display:block}
    .pcard small{display:block;margin-top:6px;color:#444;font-weight:850}

    .phead{
      display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;align-items:center
    }
    .pname{font-weight:950;font-size:18px}
    .pline{font-weight:850;color:#444;margin-top:6px}
    .tag{
      display:inline-block;padding:6px 10px;border-radius:999px;
      background:#eaf7ef;border:1px solid #cfeedd;
      font-weight:950;color:#145a2a;font-size:12px
    }
    .err{
      margin-top:12px;
      padding:12px;border-radius:14px;
      background:#fff3d6;border:1px solid #ffe1a6;
      font-weight:900;color:#333;display:none
    }

    @media(max-width:800px){
      .pgrid{grid-template-columns:repeat(2,1fr)}
    }
	
	.shareRow{
  margin-top:12px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.shareBtn{
  flex:1;
  border:none;
  background:#25D366;
  color:#fff;
  font-weight:950;
  padding:12px 14px;
  border-radius:14px;
  cursor:pointer;
}
.copyBtn{
  flex:1;
  border:none;
  background:#0a84ff;
  color:#fff;
  font-weight:950;
  padding:12px 14px;
  border-radius:14px;
  cursor:pointer;
}
.shareBtn:hover,.copyBtn:hover{opacity:.95}

  </style>
</head>

<body>
  <div class="nav">
    <div class="navin">
      <div class="brand">BlackTerminal Computer Institute</div>
      <div class="menu">
        <a href="index.html">Home</a>
        <a href="apply.html">Apply</a>
        <a href="login.html">Posters</a>
        <a href="profile.html">My Profile</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="hero">
      <div class="badge">üë§ My Profile</div>
      <h1>Check Your Referral Earnings</h1>
      <p>Enter your referral code to view referrals, admissions and commission amount.</p>
    </div>

    <div class="box">
      <b>Enter Referral Code</b>
      <input id="code" placeholder="Example: BT017" />
      <button class="btn" onclick="findProfile()">üîç Search</button>

      <div class="err" id="err">No record found for this code.</div>
    </div>

    <div class="profile" id="profile">
      <div class="phead">
        <div>
          <div class="pname" id="pname">Name</div>
          <div class="pline" id="pcity">City</div>
        </div>
        <div class="tag" id="pcode">CODE</div>
      </div>

      <div class="pgrid">
        <div class="pcard"><b id="pref">0</b><small>Referrals</small></div>
        <div class="pcard"><b id="padm">0</b><small>Admissions</small></div>
        <div class="pcard"><b id="pamt">‚Çπ0</b><small>Commission</small></div>
        <div class="pcard"><b id="pstatus">Active</b><small>Status</small></div>
      </div>
	  
	  <div class="shareRow">
  <button class="shareBtn" onclick="shareProfileWA()">üì§ Share My Profile on WhatsApp</button>
  <button class="copyBtn" onclick="copyCode()">üìã Copy Referral Code</button>
</div>

    </div>
  </div>

<script>
  // ‚úÖ Replace with your Google Sheet ID
  const SHEET_ID = "1YW6QuBtryedN8L2t-Q6laTJE46VI8oarUFlVBvui4Mw";

  // Sheet as JSON using opensheet (easy)
  const sheetURL = "https://opensheet.elk.sh/" + SHEET_ID + "/Sheet1";

  async function findProfile(){

    const code = document.getElementById("code").value.trim().toUpperCase();
    const err = document.getElementById("err");
    const prof = document.getElementById("profile");

    err.style.display = "none";
    prof.style.display = "none";

    if(!code){
      err.style.display = "block";
      err.innerText = "‚ö†Ô∏è Please enter referral code.";
      return;
    }

    try{
      const res = await fetch(sheetURL);
      const data = await res.json();

      const row = data.find(r => (r.Code || "").toUpperCase() === code);

      if(!row){
        err.style.display = "block";
        err.innerText = "‚ùå No record found for code: " + code;
        return;
      }

      document.getElementById("pname").innerText = row.Name || "Promoter";
      document.getElementById("pcity").innerText = "üìç " + (row.City || "‚Äî");
      document.getElementById("pcode").innerText = code;
	  
	  lastSearchedCode = code;

      document.getElementById("pref").innerText = row.Referrals || "0";
      document.getElementById("padm").innerText = row.Admissions || "0";
      document.getElementById("pamt").innerText = "‚Çπ" + (row.Amount || "0");

      const status = (row.Admissions && Number(row.Admissions) > 0) ? "Active ‚úÖ" : "New ‚≠ê";
      document.getElementById("pstatus").innerText = status;

      prof.style.display = "block";

      // save last code
      localStorage.setItem("bt_refcode_profile", code);

    }catch(e){
      err.style.display = "block";
      err.innerText = "‚ö†Ô∏è Error loading data. Please try again later.";
    }
  }

  // auto-fill last searched code
  (function(){
    const last = localStorage.getItem("bt_refcode_profile");
    if(last){
      document.getElementById("code").value = last;
    }
  })();
  
  
  let lastSearchedCode = "";

function copyCode(){
  if(!lastSearchedCode){
    alert("Search your profile first.");
    return;
  }
  navigator.clipboard.writeText(lastSearchedCode);
  alert("‚úÖ Referral Code Copied: " + lastSearchedCode);
}

function shareProfileWA(){
  if(!lastSearchedCode){
    alert("Search your profile first.");
    return;
  }

  const url = window.location.origin + window.location.pathname + "?code=" + encodeURIComponent(lastSearchedCode);

  const name = document.getElementById("pname").innerText;
  const city = document.getElementById("pcity").innerText;
  const ref = document.getElementById("pref").innerText;
  const adm = document.getElementById("padm").innerText;
  const amt = document.getElementById("pamt").innerText;

  const msg =
    "üî• BlackTerminal Referral Job Profile\n\n" +
    "üë§ Name: " + name + "\n" +
    city + "\n" +
    "üè∑ Code: " + lastSearchedCode + "\n" +
    "üìå Referrals: " + ref + "\n" +
    "‚úÖ Admissions: " + adm + "\n" +
    "üí∞ Commission: " + amt + "\n\n" +
    "Check Profile: " + url + "\n\n" +
    "Interested? MSG ME ‚úÖ";

  window.open("https://wa.me/?text=" + encodeURIComponent(msg), "_blank");
}

</script>

</body>
</html>
