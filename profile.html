<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Profile | BlackTerminal Computer Institute</title>

  <style>
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:#f6f7fb;color:#111}
    .nav{position:sticky;top:0;z-index:99;background:#0b1220;color:#fff;padding:12px 16px}
    .navin{max-width:1050px;margin:auto;display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{font-weight:950}
    .menu{display:flex;gap:10px;flex-wrap:wrap}
    .menu a{color:#fff;text-decoration:none;font-weight:850;font-size:13px;opacity:.92}
    .menu a:hover{opacity:1;text-decoration:underline}

    .wrap{max-width:1050px;margin:auto;padding:16px}

    .hero{background:#0b1220;color:#fff;padding:18px;border-radius:16px}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.12);font-weight:900;font-size:12px}
    h1{margin:10px 0 8px;font-size:24px}
    p{margin:0;opacity:.9;line-height:1.6;font-weight:700}

    .box{margin-top:14px;padding:16px;border:1px solid #e9e9e9;border-radius:16px;background:#fff}
    .box h2{margin:0 0 12px;font-size:18px}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .card{border:1px solid #eee;border-radius:14px;padding:12px;background:#fff}
    .money{margin-top:6px;font-size:22px;font-weight:950}

    .note{
      margin-top:10px;
      font-weight:900;
      color:#333;
      background:#f4f8ff;
      border:1px solid #dbe8ff;
      padding:10px 12px;
      border-radius:14px;
      line-height:1.6;
    }

    .btn{
      text-decoration:none;
      padding:11px 14px;
      border-radius:12px;
      font-weight:950;
      display:inline-block;
      color:#fff;
    }
    .wa{background:#25D366}

    .in{
      padding:12px;
      border-radius:12px;
      border:1px solid #ddd;
      font-weight:900;
      width:100%;
      outline:none;
    }
    .in:focus{
      border-color:#0a84ff;
      box-shadow:0 0 0 4px rgba(10,132,255,.10);
    }

    .footer{padding:18px;text-align:center;color:#555;font-weight:800}

    @media(max-width:750px){
      .grid{grid-template-columns:1fr}
    }
  </style>
</head>

<body>

  <!-- NAV -->
  <div class="nav">
    <div class="navin">
      <div class="brand">BlackTerminal Computer Institute</div>
      <div class="menu">
        <a href="index.html">Home</a>
        <a href="profile.html">My Profile</a>
        <a href="job-details.html">Job Details</a>
        <a href="how-it-works.html">How it Works</a>
        <a href="earnings.html">Earnings</a>
        <a href="apply.html">Apply</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </div>

  <div class="wrap">

    <!-- HERO -->
    <div class="hero">
      <span class="badge">ðŸ‘¤ MY PROFILE</span>
      <h1>Welcome Student âœ…</h1>
      <p>Your referral progress and withdraw details will show here.</p>
    </div>

    <!-- âœ… Earnings + Withdraw Box -->
    <div class="box" id="earnBox">
      <h2>ðŸ’° My Earnings</h2>

      <div class="grid">
        <div class="card">
          <div>Lifetime Earnings</div>
          <div class="money">â‚¹<span id="pfTotalEarn">0.00</span></div>
        </div>

        <div class="card">
          <div>Total Withdraw</div>
          <div class="money">â‚¹<span id="pfTotalWithdraw">0.00</span></div>
        </div>

        <div class="card">
          <div>Available Balance</div>
          <div class="money">â‚¹<span id="pfBalance">0.00</span></div>
        </div>
      </div>

      <div class="note">
        âœ… Send your withdrawal request on WhatsApp. Payment will be processed after admin verification.<br/>
        <b>Minimum Withdraw: â‚¹500</b>
      </div>

      <!-- âœ… Referral + UPI -->
      <div style="margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        <input id="pfReferralCode" class="in" placeholder="Enter Referral Code (required)">
        <input id="pfUPI" class="in" placeholder="Enter UPI ID (example@upi)">
      </div>

      <!-- âœ… Withdraw amount -->
      <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
        <input id="pfWithdrawAmt" class="in" type="number" min="500"
          placeholder="Enter withdraw amount (Min â‚¹500)" style="flex:1;min-width:220px;">

        <button class="btn wa" id="pfWithdrawBtn" style="border:none;cursor:pointer">
          ðŸ’¬ Request Withdraw
        </button>
      </div>

      <!-- âœ… Withdraw history -->
      <div style="margin-top:14px;">
        <h2 style="font-size:16px;margin:10px 0;">ðŸ“œ Withdraw History</h2>
        <div id="pfWithdrawHistory"></div>
      </div>
    </div>

    <div class="footer">Â© BlackTerminal Computer Institute</div>
  </div>

  <script>
    /* ===== Earnings + Withdraw system (FINAL) ===== */

    const ADMIN_WA = "917008186187";

    // âœ… Daily work lifetime earning key
    const EARN_KEY = "bt_total_earn_lifetime";

    // âœ… Withdraw keys
    const WD_KEY = "bt_withdraw_total";
    const WD_LIST_KEY = "bt_withdraw_list";

    // âœ… Referral + UPI keys
    const REF_KEY = "bt_referral_code";
    const UPI_KEY = "bt_upi_id";

    const MIN_WITHDRAW = 500;

    function num(key){
      return parseFloat(localStorage.getItem(key) || "0");
    }
    function setnum(key,val){
      localStorage.setItem(key, Number(val).toFixed(2));
    }

    function getWithdrawList(){
      try{
        return JSON.parse(localStorage.getItem(WD_LIST_KEY) || "[]");
      }catch(e){
        return [];
      }
    }
    function setWithdrawList(list){
      localStorage.setItem(WD_LIST_KEY, JSON.stringify(list));
    }

    function sendWA(text){
      window.open(`https://wa.me/${ADMIN_WA}?text=${encodeURIComponent(text)}`, "_blank");
    }

    function renderWithdrawHistory(){
      const list = getWithdrawList();
      const box = document.getElementById("pfWithdrawHistory");
      if(!box) return;

      if(list.length === 0){
        box.innerHTML = "<div style='opacity:.8;font-weight:800'>No withdraw request yet.</div>";
        return;
      }

      box.innerHTML = list.slice().reverse().map(x => `
        <div style="
          margin-top:10px;
          padding:12px;
          border-radius:14px;
          border:1px solid #eee;
          background:#fff;
          font-weight:850;">
          âœ… Withdraw: â‚¹${Number(x.amount).toFixed(2)} <br/>
          <small style="opacity:.75;font-weight:800">Date: ${x.date}</small>
        </div>
      `).join("");
    }

    function updateProfileEarningUI(){
      const totalEarn = num(EARN_KEY);
      const totalWithdraw = num(WD_KEY);
      const balance = Math.max(0, totalEarn - totalWithdraw);

      document.getElementById("pfTotalEarn").innerText = totalEarn.toFixed(2);
      document.getElementById("pfTotalWithdraw").innerText = totalWithdraw.toFixed(2);
      document.getElementById("pfBalance").innerText = balance.toFixed(2);

      // load saved referral + upi
      document.getElementById("pfReferralCode").value = localStorage.getItem(REF_KEY) || "";
      document.getElementById("pfUPI").value = localStorage.getItem(UPI_KEY) || "";

      renderWithdrawHistory();
    }

    // âœ… Auto save referral & UPI
    document.getElementById("pfReferralCode").addEventListener("input", ()=>{
      localStorage.setItem(REF_KEY, document.getElementById("pfReferralCode").value.trim());
    });
    document.getElementById("pfUPI").addEventListener("input", ()=>{
      localStorage.setItem(UPI_KEY, document.getElementById("pfUPI").value.trim());
    });

    // âœ… Withdraw button
    document.getElementById("pfWithdrawBtn").addEventListener("click", ()=>{
      const amt = Number(document.getElementById("pfWithdrawAmt").value || 0);

      const referral = (document.getElementById("pfReferralCode").value || "").trim();
      const upi = (document.getElementById("pfUPI").value || "").trim();

      if(!referral){
        alert("Please enter your Referral Code");
        return;
      }
      if(!upi || !upi.includes("@")){
        alert("Please enter valid UPI ID (example@upi)");
        return;
      }

      if(!amt || amt <= 0){
        alert("Enter valid withdraw amount");
        return;
      }

      if(amt < MIN_WITHDRAW){
        alert("Minimum withdraw amount is â‚¹500");
        return;
      }

      const totalEarn = num(EARN_KEY);
      const totalWithdraw = num(WD_KEY);
      const balance = Math.max(0, totalEarn - totalWithdraw);

      if(amt > balance){
        alert("Not enough balance!");
        return;
      }

      // âœ… update withdraw totals
      setnum(WD_KEY, totalWithdraw + amt);

      // âœ… save history
      const list = getWithdrawList();
      list.push({
        amount: amt,
        date: new Date().toLocaleString()
      });
      setWithdrawList(list);

      // âœ… WhatsApp message
      const msg =
`ðŸ’¸ WITHDRAW REQUEST
Institute: BlackTerminal Computer Institute

Referral Code: ${referral}
UPI ID: ${upi}

Requested Amount: â‚¹${amt.toFixed(2)}
Available Balance After Request: â‚¹${(balance-amt).toFixed(2)}
Date: ${new Date().toLocaleString()}

âœ… Please verify and process payment.`;

      sendWA(msg);

      document.getElementById("pfWithdrawAmt").value = "";
      updateProfileEarningUI();
    });

    // INIT
    updateProfileEarningUI();
  </script>

</body>
</html>